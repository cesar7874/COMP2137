#!/bin/bash

# Get variables
HOSTNAME=$(hostname)
USERNAME=$(whoami)
DATE=$(date)
OS_INFO=$(source /etc/os-release && echo "$NAME $VERSION")
UPTIME=$(uptime -p)
CPU=$(lscpu | grep 'Model name' | awk -F ':' '{print $2}' | xargs)
RAM=$(free -h | awk '/Mem:/ {print $2}')
DISKS=$(lsblk -d -o NAME,SIZE,MODEL | grep -v NAME)
VIDEO=$(lspci | grep -i vga | cut -d ':' -f3 | xargs)
IP_ADDR=$(hostname -I | awk '{print $1}')
GATEWAY=$(ip route | grep default | awk '{print $3}')
DNS=$(grep 'nameserver' /etc/resolv.conf | awk '{print $2}' | head -n 1)
USERS=$(who | awk '{print $1}' | sort | uniq | paste -sd "," -)
DISK_SPACE=$(df -h --output=target,avail | grep -v 'Mounted')
PROC_COUNT=$(ps -e --no-headers | wc -l)
LOAD_AVG=$(cat /proc/loadavg | awk '{print $1", "$2", "$3}')
PORTS=$(ss -tuln | awk 'NR>1 {print $5}' | cut -d ':' -f2 | sort -u | paste -sd "," -)
UFW_STATUS=$(sudo ufw status | head -n 1)

# Output
echo ""
echo "System Report for $HOSTNAME generated by $USERNAME, on $DATE"
echo ""
echo "System Information"
echo "------------------"
echo "OS: $OS_INFO"
echo "Uptime: $UPTIME"
echo "CPU: $CPU"
echo "RAM: $RAM"
echo "Disk(s):"
echo "$DISKS"
echo "Video: $VIDEO"
echo "Host Address: $IP_ADDR"
echo "Gateway IP: $GATEWAY"
echo "DNS Server: $DNS"
echo ""
echo "System Status"
echo "-------------"
echo "Users Logged In: $USERS"
echo "Disk Space:"
echo "$DISK_SPACE"
echo "Process Count: $PROC_COUNT"
echo "Load Averages: $LOAD_AVG"
echo "Listening Network Ports: $PORTS"
echo "UFW Status: $UFW_STATUS"
echo ""
